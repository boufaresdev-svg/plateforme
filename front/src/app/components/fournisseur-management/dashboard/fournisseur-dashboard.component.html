<div class="dashboard-view">
  <!-- KPI Cards Section -->
  <div class="stats-container">
    <div class="stat-card primary">
      <div class="stat-icon">ğŸ‘¥</div>
      <div class="stat-content">
        <div class="stat-number">{{ stats.totalFournisseurs }}</div>
        <div class="stat-label">Total Fournisseurs</div>
        <div class="stat-trend positive" *ngIf="stats.totalFournisseurs > 0">
          <span class="trend-icon">ğŸ“ˆ</span>
          <span class="trend-text">Base de donnÃ©es</span>
        </div>
      </div>
    </div>

    <div class="stat-card success">
      <div class="stat-icon">âœ…</div>
      <div class="stat-content">
        <div class="stat-number">{{ stats.fournisseursActifs }}</div>
        <div class="stat-label">Fournisseurs Actifs</div>
        <div class="stat-trend positive" *ngIf="stats.fournisseursActifs > 0">
          <span class="trend-icon">ğŸ’¼</span>
          <span class="trend-text">{{ getActivePercentage() }}% actifs</span>
        </div>
      </div>
    </div>

    <div class="stat-card warning" *ngIf="stats.totalDettes > 0">
      <div class="stat-icon">ğŸ“‹</div>
      <div class="stat-content">
        <div class="stat-number">{{ stats.totalDettes }}</div>
        <div class="stat-label">Total Dettes</div>
        <div class="stat-trend neutral">
          <span class="trend-icon">ğŸ“Š</span>
          <span class="trend-text">{{ stats.montantDettesNonPayees | number:'1.0-0' }} DT non payÃ©es</span>
        </div>
      </div>
    </div>

    <div class="stat-card danger" *ngIf="stats.dettesNonPayees > 0">
      <div class="stat-icon">â³</div>
      <div class="stat-content">
        <div class="stat-number">{{ stats.dettesNonPayees }}</div>
        <div class="stat-label">Dettes Non PayÃ©es</div>
        <div class="stat-trend negative">
          <span class="trend-icon">âš ï¸</span>
          <span class="trend-text">NÃ©cessite attention</span>
        </div>
      </div>
    </div>

    <div class="stat-card danger" *ngIf="stats.dettesEnRetard > 0">
      <div class="stat-icon">âš ï¸</div>
      <div class="stat-content">
        <div class="stat-number">{{ stats.dettesEnRetard }}</div>
        <div class="stat-label">Dettes En Retard</div>
        <div class="stat-trend negative">
          <span class="trend-icon">ğŸ”¥</span>
          <span class="trend-text">Action urgente</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Top Fournisseurs Section -->
  <div class="dashboard-grid">
    <div class="dashboard-section">
      <div class="section-header">
        <h2>ğŸ† Top Fournisseurs</h2>
        <button class="btn-outline" (click)="goToFournisseurs()">
          Voir tout
          <span class="icon">â†’</span>
        </button>
      </div>

      <div class="top-fournisseurs-list">
        <div *ngFor="let fournisseur of getTopFournisseurs(); let i = index" 
             class="top-fournisseur-item" 
             (click)="viewFournisseurDetails(fournisseur)">
          <div class="rank-badge" [ngClass]="getRankClass(i)">
            <span class="rank-number">{{ i + 1 }}</span>
          </div>
          <div class="fournisseur-info">
            <div class="fournisseur-name">{{ fournisseur.nom }}</div>
            <div class="fournisseur-contact">{{ fournisseur.infoContact }}</div>
            <div class="fournisseur-stats">
              <span class="stat-item" *ngIf="fournisseur.nombreDettes && fournisseur.nombreDettes > 0">
                <span class="stat-icon">ğŸ“‹</span>
                {{ fournisseur.nombreDettes }} dette(s)
              </span>
              <span class="stat-item" *ngIf="(fournisseur.soldeTotal ?? 0) > 0" style="color: #f57c00;">
                <span class="stat-icon">ğŸ’³</span>
                {{ (fournisseur.soldeTotal ?? 0) | number:'1.2-2' }} DT solde
              </span>
              <span class="stat-item" 
                    *ngIf="(fournisseur.montantAPayer ?? 0) > 0" 
                    [style.color]="(fournisseur.montantAPayer ?? 0) > 0 ? '#d32f2f' : '#2e7d32'">
                <span class="stat-icon">âš </span>
                {{ (fournisseur.montantAPayer ?? 0) | number:'1.2-2' }} DT Ã  payer
              </span>
            </div>
          </div>
          <div class="action-arrow">â†’</div>
        </div>
      </div>
    </div>

    <div class="dashboard-section">
      <div class="section-header">
        <h2>ğŸ“Š AperÃ§u RÃ©cent</h2>
        <button class="btn-outline" (click)="goToDettes()">
          Voir dettes
          <span class="icon">â†’</span>
        </button>
      </div>

      <div class="recent-activities">
        <div class="activity-item" *ngFor="let dette of getRecentDettes()">
          <div class="activity-icon" [ngClass]="getDetteStatusClass(dette)">
            <span *ngIf="dette.estPaye">âœ…</span>
            <span *ngIf="!dette.estPaye && !isOverdue(dette)">â³</span>
            <span *ngIf="!dette.estPaye && isOverdue(dette)">ğŸš¨</span>
          </div>
          <div class="activity-content">
            <div class="activity-title">{{ getFournisseurName(dette.fournisseurId) }}</div>
            <div class="activity-description">
              {{ dette.montantDu | number:'1.0-0' }} DT - 
              {{ dette.estPaye ? 'PayÃ©e' : 'Ã‰chÃ©ance: ' + (dette.datePaiementPrevue | date:'dd/MM/yyyy') }}
            </div>
          </div>
          <div class="activity-amount" [ngClass]="getDetteStatusClass(dette)">
            {{ dette.montantDu | number:'1.0-0' }} DT
          </div>
        </div>
      </div>
    </div>
  </div>
</div>